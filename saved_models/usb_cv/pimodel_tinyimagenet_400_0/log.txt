[2022-11-24 18:41:59,829 INFO] Use GPU: 0 for training
[2022-11-24 18:42:00,389 INFO] unlabeled data number: 100000, labeled data number 400
[2022-11-24 18:42:01,852 INFO] Create train and test data loaders
[2022-11-24 18:42:01,852 INFO] [!] data loader keys: dict_keys(['train_lb', 'train_ulb', 'eval'])
[2022-11-24 18:42:02,515 INFO] Create optimizer and scheduler
[2022-11-24 18:42:02,518 INFO] Number of Trainable Params: 21475400
[2022-11-24 18:42:02,594 INFO] Arguments: Namespace(algorithm='pimodel', amp=False, batch_size=8, c='config/usb_cv/pimodel/pimodel_tinyimagenet_400_0.yaml', clip=0.0, clip_grad=0, crop_ratio=0.875, data_dir='./data', dataset='tinyimagenet', dist_backend='nccl', dist_url='tcp://127.0.0.1:27186', distributed=True, ema_m=0.0, epoch=200, eval_batch_size=16, gpu=0, imb_algorithm=None, img_size=32, layer_decay=1.0, lb_dest_len=400, lb_imb_ratio=1, load_path='./saved_models/usb_cv//pimodel_tinyimagenet_400_0/latest_model.pth', lr=5e-05, max_length=512, max_length_seconds=4.0, momentum=0.9, multiprocessing_distributed=True, net='vit_small_patch2_32', net_from_name=False, num_classes=200, num_eval_iter=2048, num_labels=400, num_log_iter=512, num_train_iter=204800, num_warmup_iter=5120, num_workers=3, optim='AdamW', overwrite=True, pretrain_path='https://github.com/microsoft/Semi-supervised-learning/releases/download/v.0.0.0/vit_small_patch2_32_mlp_im_1k_32.pth', rank=0, resume=True, sample_rate=16000, save_dir='./saved_models/usb_cv/', save_name='pimodel_tinyimagenet_400_0', seed=1, train_sampler='RandomSampler', ulb_dest_len=100000, ulb_imb_ratio=1, ulb_loss_ratio=10, ulb_num_labels=None, unsup_warm_up=0.4, uratio=1, use_amp=False, use_cat=True, use_pretrain=True, use_tensorboard=True, weight_decay=0.0005, world_size=1)
[2022-11-24 18:42:02,594 INFO] Resume load path ./saved_models/usb_cv//pimodel_tinyimagenet_400_0/latest_model.pth does not exist
[2022-11-24 18:42:02,594 INFO] Model training
[2022-11-24 18:47:26,020 INFO] 512 iteration, USE_EMA: False, {'train/sup_loss': 5.914297103881836, 'train/unsup_loss': 1.9413833797443658e-05, 'train/total_loss': 5.9142985343933105, 'lr': 5e-06, 'train/prefecth_time': 0.036222496032714845, 'train/run_time': 0.5801734619140625}
[2022-11-24 18:52:42,739 INFO] 1024 iteration, USE_EMA: False, {'train/sup_loss': 5.253678321838379, 'train/unsup_loss': 1.746600537444465e-05, 'train/total_loss': 5.25368070602417, 'lr': 1e-05, 'train/prefecth_time': 0.0347325439453125, 'train/run_time': 0.5849636840820313}
[2022-11-24 18:58:10,414 INFO] 1536 iteration, USE_EMA: False, {'train/sup_loss': 5.616192817687988, 'train/unsup_loss': 1.8225207895739004e-05, 'train/total_loss': 5.616196155548096, 'lr': 1.5e-05, 'train/prefecth_time': 0.03474816131591797, 'train/run_time': 0.5823805541992187}
[2022-11-24 19:03:26,514 INFO] validating...
[2022-11-24 19:05:14,495 INFO] confusion matrix:
[[0.02040816 0.         0.         ... 0.02040816 0.         0.        ]
 [0.         0.02040816 0.         ... 0.02040816 0.         0.        ]
 [0.         0.02040816 0.         ... 0.         0.         0.06122449]
 ...
 [0.         0.         0.         ... 0.42857143 0.         0.02040816]
 [0.         0.         0.         ... 0.36734694 0.         0.        ]
 [0.         0.         0.         ... 0.02040816 0.02040816 0.02040816]]
[2022-11-24 19:05:15,012 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 19:05:15,526 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 19:05:15,526 INFO] 2048 iteration, USE_EMA: False, {'train/sup_loss': 4.2346367835998535, 'train/unsup_loss': 1.3940841199655551e-05, 'train/total_loss': 4.234640121459961, 'lr': 2e-05, 'train/prefecth_time': 0.033296863555908204, 'train/run_time': 0.5815233764648438, 'eval/loss': 5.183408482220708, 'eval/top-1-acc': 0.027142857142857142, 'eval/balanced_acc': 0.027142857142857146, 'eval/precision': 0.027348920884612164, 'eval/recall': 0.027142857142857146, 'eval/F1': 0.0228103627082566}, BEST_EVAL_ACC: 0.027142857142857142, at 2048 iters
[2022-11-24 19:10:43,590 INFO] 2560 iteration, USE_EMA: False, {'train/sup_loss': 4.028606414794922, 'train/unsup_loss': 1.8033015294349752e-05, 'train/total_loss': 4.02861213684082, 'lr': 2.5e-05, 'train/prefecth_time': 0.03284268951416015, 'train/run_time': 0.5785413818359375}
[2022-11-24 19:15:59,312 INFO] 3072 iteration, USE_EMA: False, {'train/sup_loss': 2.7610151767730713, 'train/unsup_loss': 1.7110613043769263e-05, 'train/total_loss': 2.761021614074707, 'lr': 3e-05, 'train/prefecth_time': 0.03201542282104492, 'train/run_time': 0.5867882690429688}
[2022-11-24 19:21:26,870 INFO] 3584 iteration, USE_EMA: False, {'train/sup_loss': 2.4565365314483643, 'train/unsup_loss': 2.4183722416637465e-05, 'train/total_loss': 2.4565470218658447, 'lr': 3.5e-05, 'train/prefecth_time': 0.03431782531738281, 'train/run_time': 0.5827239990234375}
[2022-11-24 19:26:43,227 INFO] validating...
[2022-11-24 19:28:30,648 INFO] confusion matrix:
[[0.         0.         0.         ... 0.         0.         0.        ]
 [0.         0.34693878 0.02040816 ... 0.         0.         0.        ]
 [0.         0.         0.14285714 ... 0.         0.         0.        ]
 ...
 [0.         0.         0.         ... 0.48979592 0.08163265 0.        ]
 [0.         0.         0.         ... 0.32653061 0.         0.        ]
 [0.02040816 0.02040816 0.         ... 0.02040816 0.         0.06122449]]
[2022-11-24 19:28:34,860 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 19:28:36,981 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 19:28:36,982 INFO] 4096 iteration, USE_EMA: False, {'train/sup_loss': 1.196205735206604, 'train/unsup_loss': 4.042111322632991e-05, 'train/total_loss': 1.196225881576538, 'lr': 4e-05, 'train/prefecth_time': 0.033254367828369144, 'train/run_time': 0.5857886352539062, 'eval/loss': 4.4143782218621705, 'eval/top-1-acc': 0.17775510204081632, 'eval/balanced_acc': 0.17775510204081635, 'eval/precision': 0.17908845897284653, 'eval/recall': 0.17775510204081635, 'eval/F1': 0.17091701174602275}, BEST_EVAL_ACC: 0.17775510204081632, at 4096 iters
[2022-11-24 19:34:04,402 INFO] 4608 iteration, USE_EMA: False, {'train/sup_loss': 1.4098905324935913, 'train/unsup_loss': 7.184983405750245e-05, 'train/total_loss': 1.409930944442749, 'lr': 4.5e-05, 'train/prefecth_time': 0.03438896179199219, 'train/run_time': 0.5955945434570312}
[2022-11-24 19:39:20,467 INFO] 5120 iteration, USE_EMA: False, {'train/sup_loss': 0.20457419753074646, 'train/unsup_loss': 5.214438715483993e-05, 'train/total_loss': 0.2046067863702774, 'lr': 5e-05, 'train/prefecth_time': 0.03776988983154297, 'train/run_time': 0.5771275634765625}
[2022-11-24 19:44:48,368 INFO] 5632 iteration, USE_EMA: False, {'train/sup_loss': 0.39490631222724915, 'train/unsup_loss': 9.345474245492369e-05, 'train/total_loss': 0.39497053623199463, 'lr': 4.9999689496710696e-05, 'train/prefecth_time': 0.047227775573730466, 'train/run_time': 0.5813230590820313}
[2022-11-24 19:50:04,786 INFO] validating...
[2022-11-24 19:51:52,375 INFO] confusion matrix:
[[0.02040816 0.         0.         ... 0.         0.         0.        ]
 [0.         0.48979592 0.         ... 0.         0.         0.        ]
 [0.         0.         0.14285714 ... 0.         0.         0.02040816]
 ...
 [0.         0.         0.         ... 0.44897959 0.02040816 0.        ]
 [0.         0.         0.         ... 0.20408163 0.02040816 0.        ]
 [0.         0.02040816 0.         ... 0.         0.02040816 0.14285714]]
[2022-11-24 19:51:56,253 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 19:51:58,103 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 19:51:58,103 INFO] 6144 iteration, USE_EMA: False, {'train/sup_loss': 0.23232032358646393, 'train/unsup_loss': 0.00011816213373094797, 'train/total_loss': 0.23240892589092255, 'lr': 4.9998757990699265e-05, 'train/prefecth_time': 0.03437231826782226, 'train/run_time': 0.5814284057617187, 'eval/loss': 3.945936623884707, 'eval/top-1-acc': 0.23795918367346938, 'eval/balanced_acc': 0.23795918367346938, 'eval/precision': 0.2561087203735348, 'eval/recall': 0.23795918367346938, 'eval/F1': 0.232762588227913}, BEST_EVAL_ACC: 0.23795918367346938, at 6144 iters
[2022-11-24 19:57:25,602 INFO] 6656 iteration, USE_EMA: False, {'train/sup_loss': 0.18795642256736755, 'train/unsup_loss': 8.82009626366198e-05, 'train/total_loss': 0.18802808225154877, 'lr': 4.9997205493535134e-05, 'train/prefecth_time': 0.035817951202392576, 'train/run_time': 0.58278466796875}
[2022-11-24 20:02:41,794 INFO] 7168 iteration, USE_EMA: False, {'train/sup_loss': 0.0482453890144825, 'train/unsup_loss': 0.0002732141292653978, 'train/total_loss': 0.04848441854119301, 'lr': 4.999503202450052e-05, 'train/prefecth_time': 0.03296342468261719, 'train/run_time': 0.5852144165039063}
[2022-11-24 20:08:09,431 INFO] 7680 iteration, USE_EMA: False, {'train/sup_loss': 0.11417041718959808, 'train/unsup_loss': 9.942833275999874e-05, 'train/total_loss': 0.114263616502285, 'lr': 4.9992237610590205e-05, 'train/prefecth_time': 0.034594879150390626, 'train/run_time': 0.580663818359375}
[2022-11-24 20:13:25,812 INFO] validating...
[2022-11-24 20:15:13,248 INFO] confusion matrix:
[[0.04081633 0.         0.         ... 0.         0.         0.        ]
 [0.         0.44897959 0.         ... 0.         0.         0.        ]
 [0.         0.         0.2244898  ... 0.         0.         0.02040816]
 ...
 [0.         0.         0.         ... 0.44897959 0.04081633 0.        ]
 [0.         0.         0.         ... 0.2244898  0.04081633 0.        ]
 [0.         0.02040816 0.         ... 0.         0.02040816 0.18367347]]
[2022-11-24 20:15:16,807 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 20:15:19,186 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 20:15:19,187 INFO] 8192 iteration, USE_EMA: False, {'train/sup_loss': 0.09277235716581345, 'train/unsup_loss': 0.00013880428741686046, 'train/total_loss': 0.09291114658117294, 'lr': 4.998882228651117e-05, 'train/prefecth_time': 0.03531862258911133, 'train/run_time': 0.5782153930664062, 'eval/loss': 3.7559017246596667, 'eval/top-1-acc': 0.25979591836734695, 'eval/balanced_acc': 0.25979591836734695, 'eval/precision': 0.2700682073264295, 'eval/recall': 0.25979591836734695, 'eval/F1': 0.2537519754711817}, BEST_EVAL_ACC: 0.25979591836734695, at 8192 iters
[2022-11-24 20:20:47,972 INFO] 8704 iteration, USE_EMA: False, {'train/sup_loss': 0.06180473789572716, 'train/unsup_loss': 0.00018650580022949725, 'train/total_loss': 0.06200287863612175, 'lr': 4.998478609468219e-05, 'train/prefecth_time': 0.03438655853271484, 'train/run_time': 0.5836419677734375}
[2022-11-24 20:26:04,010 INFO] 9216 iteration, USE_EMA: False, {'train/sup_loss': 0.011992915533483028, 'train/unsup_loss': 0.00011381956574041396, 'train/total_loss': 0.012120949104428291, 'lr': 4.99801290852333e-05, 'train/prefecth_time': 0.03493008041381836, 'train/run_time': 0.5825851440429688}
[2022-11-24 20:31:31,551 INFO] 9728 iteration, USE_EMA: False, {'train/sup_loss': 0.019385701045393944, 'train/unsup_loss': 0.0001108528085751459, 'train/total_loss': 0.01951732486486435, 'lr': 4.9974851316005164e-05, 'train/prefecth_time': 0.03470073699951172, 'train/run_time': 0.5837024536132812}
[2022-11-24 20:36:48,058 INFO] validating...
[2022-11-24 20:38:35,531 INFO] confusion matrix:
[[0.04081633 0.         0.         ... 0.         0.         0.        ]
 [0.         0.51020408 0.         ... 0.         0.         0.        ]
 [0.         0.         0.12244898 ... 0.         0.02040816 0.08163265]
 ...
 [0.         0.         0.         ... 0.46938776 0.04081633 0.        ]
 [0.         0.         0.         ... 0.26530612 0.06122449 0.        ]
 [0.         0.         0.         ... 0.02040816 0.         0.3877551 ]]
[2022-11-24 20:38:36,954 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 20:38:43,582 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 20:38:43,586 INFO] 10240 iteration, USE_EMA: False, {'train/sup_loss': 0.10900817066431046, 'train/unsup_loss': 0.000606259738560766, 'train/total_loss': 0.10976592451334, 'lr': 4.996895285254838e-05, 'train/prefecth_time': 0.03502604675292969, 'train/run_time': 0.5839921264648438, 'eval/loss': 3.7442265649960964, 'eval/top-1-acc': 0.2603061224489796, 'eval/balanced_acc': 0.2603061224489796, 'eval/precision': 0.28286745643589106, 'eval/recall': 0.2603061224489796, 'eval/F1': 0.25640761594057393}, BEST_EVAL_ACC: 0.2603061224489796, at 10240 iters
[2022-11-24 20:44:11,260 INFO] 10752 iteration, USE_EMA: False, {'train/sup_loss': 0.0037885273341089487, 'train/unsup_loss': 0.0004122744139749557, 'train/total_loss': 0.004329587332904339, 'lr': 4.996243376812264e-05, 'train/prefecth_time': 0.034307167053222655, 'train/run_time': 0.5851441650390625}
[2022-11-24 20:49:27,405 INFO] 11264 iteration, USE_EMA: False, {'train/sup_loss': 0.00611609872430563, 'train/unsup_loss': 0.0003202768857590854, 'train/total_loss': 0.006556440144777298, 'lr': 4.995529414369582e-05, 'train/prefecth_time': 0.0345300178527832, 'train/run_time': 0.58477490234375}
[2022-11-24 20:54:54,662 INFO] 11776 iteration, USE_EMA: False, {'train/sup_loss': 0.005259114317595959, 'train/unsup_loss': 0.00014406617265194654, 'train/total_loss': 0.005466192029416561, 'lr': 4.994753406794301e-05, 'train/prefecth_time': 0.034748287200927735, 'train/run_time': 0.5827727661132812}
[2022-11-24 21:00:10,768 INFO] validating...
[2022-11-24 21:01:58,270 INFO] confusion matrix:
[[0.08163265 0.         0.         ... 0.         0.         0.        ]
 [0.         0.53061224 0.         ... 0.         0.         0.        ]
 [0.         0.         0.16326531 ... 0.         0.         0.02040816]
 ...
 [0.         0.         0.         ... 0.34693878 0.04081633 0.        ]
 [0.         0.         0.         ... 0.14285714 0.04081633 0.        ]
 [0.         0.         0.         ... 0.         0.         0.30612245]]
[2022-11-24 21:02:01,597 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 21:02:03,014 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 21:02:03,015 INFO] 12288 iteration, USE_EMA: False, {'train/sup_loss': 0.0024176184087991714, 'train/unsup_loss': 0.0010288979392498732, 'train/total_loss': 0.003960839472711086, 'lr': 4.993915363724536e-05, 'train/prefecth_time': 0.033762046813964844, 'train/run_time': 0.5794972534179688, 'eval/loss': 3.681706036353598, 'eval/top-1-acc': 0.27510204081632655, 'eval/balanced_acc': 0.2751020408163265, 'eval/precision': 0.29641208386975715, 'eval/recall': 0.2751020408163265, 'eval/F1': 0.271698022362286}, BEST_EVAL_ACC: 0.27510204081632655, at 12288 iters
[2022-11-24 21:07:30,480 INFO] 12800 iteration, USE_EMA: False, {'train/sup_loss': 0.003391705919057131, 'train/unsup_loss': 0.0003603911027312279, 'train/total_loss': 0.003954772837460041, 'lr': 4.993015295568891e-05, 'train/prefecth_time': 0.033937919616699216, 'train/run_time': 0.5819107666015625}
[2022-11-24 21:12:46,936 INFO] 13312 iteration, USE_EMA: False, {'train/sup_loss': 0.0021908448543399572, 'train/unsup_loss': 0.0002847065043170005, 'train/total_loss': 0.0026534581556916237, 'lr': 4.992053213506334e-05, 'train/prefecth_time': 0.03432400131225586, 'train/run_time': 0.5846887817382812}
[2022-11-24 21:18:14,720 INFO] 13824 iteration, USE_EMA: False, {'train/sup_loss': 0.001958542037755251, 'train/unsup_loss': 0.0007366873323917389, 'train/total_loss': 0.00320161203853786, 'lr': 4.991029129486048e-05, 'train/prefecth_time': 0.033697025299072265, 'train/run_time': 0.5811344604492188}
[2022-11-24 21:23:31,282 INFO] validating...
[2022-11-24 21:25:18,736 INFO] confusion matrix:
[[0.12244898 0.         0.         ... 0.         0.         0.        ]
 [0.         0.48979592 0.         ... 0.         0.         0.        ]
 [0.         0.         0.16326531 ... 0.         0.         0.06122449]
 ...
 [0.         0.         0.         ... 0.55102041 0.04081633 0.        ]
 [0.         0.         0.         ... 0.3877551  0.08163265 0.        ]
 [0.         0.         0.         ... 0.02040816 0.         0.30612245]]
[2022-11-24 21:25:20,011 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 21:25:24,939 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 21:25:24,939 INFO] 14336 iteration, USE_EMA: False, {'train/sup_loss': 0.005580098833888769, 'train/unsup_loss': 0.00028012291295453906, 'train/total_loss': 0.006070279516279697, 'lr': 4.989943056227294e-05, 'train/prefecth_time': 0.034819297790527344, 'train/run_time': 0.5788394165039062, 'eval/loss': 3.633043634088672, 'eval/top-1-acc': 0.2789795918367347, 'eval/balanced_acc': 0.27897959183673465, 'eval/precision': 0.2933059829103584, 'eval/recall': 0.27897959183673465, 'eval/F1': 0.2718958043052059}, BEST_EVAL_ACC: 0.2789795918367347, at 14336 iters
[2022-11-24 21:30:52,028 INFO] 14848 iteration, USE_EMA: False, {'train/sup_loss': 0.0014354735612869263, 'train/unsup_loss': 0.0003666514530777931, 'train/total_loss': 0.002099984558299184, 'lr': 4.988795007219242e-05, 'train/prefecth_time': 0.03352396774291992, 'train/run_time': 0.5867316284179688}
[2022-11-24 21:36:08,094 INFO] 15360 iteration, USE_EMA: False, {'train/sup_loss': 0.006122898310422897, 'train/unsup_loss': 0.00012976318248547614, 'train/total_loss': 0.006366188637912273, 'lr': 4.9875849967208134e-05, 'train/prefecth_time': 0.03437526321411133, 'train/run_time': 0.5804735717773437}
[2022-11-24 21:41:35,313 INFO] 15872 iteration, USE_EMA: False, {'train/sup_loss': 0.005279649049043655, 'train/unsup_loss': 0.00019313969823997468, 'train/total_loss': 0.005653833504766226, 'lr': 4.9863130397604966e-05, 'train/prefecth_time': 0.03439673614501953, 'train/run_time': 0.5840335083007813}
[2022-11-24 21:46:51,160 INFO] validating...
[2022-11-24 21:48:38,567 INFO] confusion matrix:
[[0.10204082 0.         0.         ... 0.         0.         0.        ]
 [0.         0.55102041 0.         ... 0.         0.         0.        ]
 [0.         0.         0.12244898 ... 0.         0.         0.06122449]
 ...
 [0.         0.         0.         ... 0.3877551  0.04081633 0.        ]
 [0.         0.         0.         ... 0.2244898  0.06122449 0.        ]
 [0.         0.         0.         ... 0.02040816 0.         0.34693878]]
[2022-11-24 21:48:42,534 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 21:48:44,065 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 21:48:44,065 INFO] 16384 iteration, USE_EMA: False, {'train/sup_loss': 0.002935881959274411, 'train/unsup_loss': 0.0006774933426640928, 'train/total_loss': 0.0042907861061394215, 'lr': 4.984979152136166e-05, 'train/prefecth_time': 0.03332412719726562, 'train/run_time': 0.5848264770507813, 'eval/loss': 3.6896512758762254, 'eval/top-1-acc': 0.28377551020408165, 'eval/balanced_acc': 0.28377551020408165, 'eval/precision': 0.2984130799012976, 'eval/recall': 0.28377551020408165, 'eval/F1': 0.2771714635393343}, BEST_EVAL_ACC: 0.28377551020408165, at 16384 iters
[2022-11-24 21:54:11,748 INFO] 16896 iteration, USE_EMA: False, {'train/sup_loss': 0.0016150007722899318, 'train/unsup_loss': 0.0005871459725312889, 'train/total_loss': 0.002825917676091194, 'lr': 4.9835833504148804e-05, 'train/prefecth_time': 0.03517055892944336, 'train/run_time': 0.5799755859375}
[2022-11-24 21:59:27,732 INFO] 17408 iteration, USE_EMA: False, {'train/sup_loss': 0.0003568899992387742, 'train/unsup_loss': 0.0004551939491648227, 'train/total_loss': 0.0013241216074675322, 'lr': 4.9821256519326806e-05, 'train/prefecth_time': 0.033197086334228514, 'train/run_time': 0.5857177124023437}
[2022-11-24 22:04:55,606 INFO] 17920 iteration, USE_EMA: False, {'train/sup_loss': 0.0033284351229667664, 'train/unsup_loss': 0.0001368195516988635, 'train/total_loss': 0.003627711208537221, 'lr': 4.980606074794375e-05, 'train/prefecth_time': 0.03483302307128906, 'train/run_time': 0.5808474731445312}
[2022-11-24 22:10:11,278 INFO] validating...
[2022-11-24 22:11:58,789 INFO] confusion matrix:
[[0.08163265 0.         0.         ... 0.         0.         0.        ]
 [0.         0.53061224 0.         ... 0.         0.         0.        ]
 [0.         0.         0.16326531 ... 0.         0.         0.02040816]
 ...
 [0.         0.         0.         ... 0.51020408 0.02040816 0.        ]
 [0.         0.         0.         ... 0.26530612 0.06122449 0.        ]
 [0.         0.         0.         ... 0.02040816 0.         0.30612245]]
[2022-11-24 22:12:00,257 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/latest_model.pth
[2022-11-24 22:12:04,964 INFO] model saved: ./saved_models/usb_cv/pimodel_tinyimagenet_400_0/model_best.pth
[2022-11-24 22:12:04,965 INFO] 18432 iteration, USE_EMA: False, {'train/sup_loss': 0.0004412014386616647, 'train/unsup_loss': 0.000554656027816236, 'train/total_loss': 0.001689109718427062, 'lr': 4.979024637873309e-05, 'train/prefecth_time': 0.03995939254760742, 'train/run_time': 0.576319091796875, 'eval/loss': 3.6781905159779957, 'eval/top-1-acc': 0.2893877551020408, 'eval/balanced_acc': 0.2893877551020408, 'eval/precision': 0.2958416745761457, 'eval/recall': 0.2893877551020408, 'eval/F1': 0.27938917293918175}, BEST_EVAL_ACC: 0.2893877551020408, at 18432 iters
[2022-11-24 22:17:31,880 INFO] 18944 iteration, USE_EMA: False, {'train/sup_loss': 0.0012001895811408758, 'train/unsup_loss': 0.00029841094510629773, 'train/total_loss': 0.0018902284791693091, 'lr': 4.977381360811139e-05, 'train/prefecth_time': 0.03300934219360351, 'train/run_time': 0.5788506469726562}
[2022-11-24 22:22:47,574 INFO] 19456 iteration, USE_EMA: False, {'train/sup_loss': 0.0007372532854788005, 'train/unsup_loss': 0.0008034244528971612, 'train/total_loss': 0.0026452881284058094, 'lr': 4.9756762640175826e-05, 'train/prefecth_time': 0.033320159912109376, 'train/run_time': 0.5816513061523437}
[2022-11-24 22:28:14,736 INFO] 19968 iteration, USE_EMA: False, {'train/sup_loss': 0.0012243313249200583, 'train/unsup_loss': 0.0008127928012982011, 'train/total_loss': 0.0032054143957793713, 'lr': 4.973909368670166e-05, 'train/prefecth_time': 0.03501526260375976, 'train/run_time': 0.5844431762695312}
